<script type="text/javascript" charset:"uft-8">
	$(function() {
		new  Highcharts.Chart({
			chart: {
				renderTo: "bills_chart",
				type: "column",
			},
			title: {
				text: "Bills by Month"
			},

			xAxis: {
				type: "datetime"
			},

			yAxis: {
				title: {
					text: "Amount"
				}
			},

			tooltip: {
				formatter: function() {
					return Highcharts.dateFormat("%B %e, %Y", this.x) + ": " + "$" + Highcharts.numberFormat(this.y, 2);
				}
			},

			series: [{
				name: "Bills",
				pointInterval: <%= 1.day * 1000 %>,
				pointStart: <%= 12.months.ago.to_i * 1000 %>,
				data: <%= (12.months.ago.to_date..Date.today).map { |date| @bills.total_on(date).to_f }.inspect %>
			}]
		})
	})
</script>
<div id="bills_chart" style="width:100%; height:100%; "></div>

<h1> Your Properties Bills: </h1>

<table class="table table-striped" border="0" style="width:100%">
	<tr>
		<th><%= sortable "id", "ID#" %></th>
		<th><%= sortable "duedate", "Due Date" %></th>
		<th><%= sortable "billtype", "Bill Type" %></th>
		<th><%= sortable "status" %></th>
		<th><%= sortable "amount" %></th>
		<th>Action</th>
	</tr>
	<% count = 1%>
	<% @bills.each do |b| %>
	<% if  b.status == "Unpaid" and b.duedate < Time.zone.now %>
		<tr class="danger">
			<td><%= b.id %></td>
			<td><%= b.duedate %></td>
			<td><%= b.billtype %></td>
			<td><%= b.status %></td>
			<td>$<%= b.amount %></td>
			<td>
				<div class="btn-group btn-group-xs" role="group" aria-label="...">
				  <div type="button" class="btn btn-default"><%= link_to "View", b %></div>
				  <div type="button" class="btn btn-default"><%= link_to "Edit", edit_bill_path(b)%></div>
				  <div type="button" class="btn btn-default"><%= link_to "Delete", bill_path(b), method: :delete, data: { confirm: "Are you sure you want to delete this bill?" }%></div>
				</div>
			</td>
			<% count+=1 %>
		</tr>
	<% else %>
	<tr>
		<td><%= b.id %></td>
		<td><%= b.duedate %></td>
		<td><%= b.billtype %></td>
		<td><%= b.status %></td>
		<td>$<%= b.amount %></td>
		<td>
			<div class="btn-group btn-group-xs" role="group" aria-label="...">
			  <div type="button" class="btn btn-default"><%= link_to "View", b %></div>
			  <div type="button" class="btn btn-default"><%= link_to "Edit", edit_bill_path(b)%></div>
			  <div type="button" class="btn btn-default"><%= link_to "Delete", bill_path(b), method: :delete, data: { confirm: "Are you sure you want to delete this bill?" }%></div>
			</div>
		</td>
		<% count+=1 %>
	</tr>
	<% end %>
<% end %>
</table>

<!-- <a class="btn btn-primary" href="/properties/new">Add new property</a> -->
<div class="form-actions">
	<%= link_to "Add new bill", new_bill_path, class: "btn btn-primary" %>
</div>